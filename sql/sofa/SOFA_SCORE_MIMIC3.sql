
WITH fio2 AS(
SELECT ev.ITEMID,
       di.LABEL,
       COUNT(ev.ITEMID)
FROM MIMIC2V30.chartevents ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%o2%')
GROUP BY ev.ITEMID, di.LABEL
ORDER BY COUNT(ev.ITEMID) DESC
)

--select * from fio2;
--223835	Inspired O2 Fraction	478576
--3420	FIO2	673927
--190	FiO2 Set	578766
--3422	FIO2 [Meas]	242323
--3421	FIO2 Alarm [Lo/Hi]	235263
--186	FIO2 Alarm-Low	10472
--185	FIO2 Alarm-High	9238
--189	FiO2 (Analyzed)	7751

,pao2 AS(
SELECT ev.ITEMID,
       di.LABEL,
       COUNT(ev.ITEMID)
FROM MIMIC2V30.chartevents ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%pao2%')
GROUP BY ev.ITEMID, di.LABEL
ORDER BY COUNT(ev.ITEMID) DESC
)

--SELECT * FROM pao2;
-- 220224	Arterial O2 pressure	117958
--779	Arterial PaO2	285817
--490	PAO2	1485

,marp AS(
SELECT ev.ITEMID,
       di.LABEL,
       COUNT(ev.ITEMID)
FROM MIMIC2V30.chartevents ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%mean%')
GROUP BY ev.ITEMID, di.LABEL
ORDER BY COUNT(ev.ITEMID) DESC
)

--SELECT * from marp;
--52	Arterial BP Mean	2093289
--456	NBP Mean	1583560
--220181	Non Invasive Blood Pressure mean	1244266
--220052	Arterial Blood Pressure mean	1047057
--224697	Mean Airway Pressure	391088
--444	Mean Airway Pressure	386460
--491	PAP Mean	267414
--3503	Mean PAW [Meas]	226429
--3312	BP Cuff [Mean]	148094
--220061	Pulmonary Artery Pressure mean	121519
--225312	ART BP mean	83777

,billi AS(
SELECT ev.ITEMID,
       di.LABEL,
       COUNT(ev.ITEMID)
--FROM MIMIC2V30.procedureevents ev
--FROM MIMIC2V30.chartevents ev
--FROM MIMIC2V30.MEDEVENTS ev
FROM MIMIC2V30.LABEVENTS ev
--FROM MIMIC2V30.IOEVENTS ev
--FROM MIMIC2V30.ICUSTAYEVENTS ev
--FROM MIMIC2V30.CENSUSEVENTS ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%bil%')
GROUP BY ev.ITEMID, di.LABEL
ORDER BY COUNT(ev.ITEMID) DESC
)

--50889	BILIRUBIN, TOTAL	166365
--51496	BILIRUBIN	77330
--SELECT * FROM billi;


,coag AS(
SELECT ev.ITEMID,
       di.LABEL,
       COUNT(ev.ITEMID)
--FROM MIMIC2V30.procedureevents ev
--FROM MIMIC2V30.chartevents ev
--FROM MIMIC2V30.MEDEVENTS ev
FROM MIMIC2V30.LABEVENTS ev
--FROM MIMIC2V30.IOEVENTS ev
--FROM MIMIC2V30.ICUSTAYEVENTS ev
--FROM MIMIC2V30.CENSUSEVENTS ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%pla%')
GROUP BY ev.ITEMID, di.LABEL
ORDER BY COUNT(ev.ITEMID) DESC
)

-- 51287	PLATELET COUNT	569796
--SELECT * FROM coag;


,creat AS(
SELECT ev.ITEMID,
       di.LABEL,
       COUNT(ev.ITEMID)
--FROM MIMIC2V30.procedureevents ev
--FROM MIMIC2V30.chartevents ev
--FROM MIMIC2V30.MEDEVENTS ev
FROM MIMIC2V30.LABEVENTS ev
--FROM MIMIC2V30.IOEVENTS ev
--FROM MIMIC2V30.ICUSTAYEVENTS ev
--FROM MIMIC2V30.CENSUSEVENTS ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%crea%')
GROUP BY ev.ITEMID, di.LABEL
ORDER BY COUNT(ev.ITEMID) DESC
)
--50916	CREATININE	587704
--50914	CREATINE KINASE (CK)	95234
--50915	CREATINE KINASE, MB ISOENZYME	87685
--51094	CREATININE, URINE	21760
SELECT * FROM creat;

-- COMA IS DONE...


,coma AS(
SELECT ev.ITEMID,
       di.LABEL,
       di.ORIGIN,
       COUNT(ev.ITEMID)
--FROM MIMIC2V30.procedureevents ev
FROM MIMIC2V30.chartevents ev
--FROM MIMIC2V30.MEDEVENTS ev
--FROM MIMIC2V30.LABEVENTS ev
--FROM MIMIC2V30.IOEVENTS ev
--FROM MIMIC2V30.ICUSTAYEVENTS ev
--FROM MIMIC2V30.CENSUSEVENTS ev
JOIN MIMIC2V30.D_ITEMS di ON di.ITEMID = ev.ITEMID 
WHERE di.ITEMID IN(SELECT ITEMID FROM MIMIC2V30.D_ITEMS WHERE lower(LABEL) LIKE '%gcs%')
GROUP BY ev.ITEMID, di.LABEL, di.ORIGIN
ORDER BY COUNT(ev.ITEMID) DESC
)
--198 GCS Total
SELECT * FROM coma;






